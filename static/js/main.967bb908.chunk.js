(this.webpackJsonptwitchtactoe=this.webpackJsonptwitchtactoe||[]).push([[0],{10:function(e,t,n){e.exports=n(11)},11:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n(2),r=n(5),c=n(3),l=n(6),i=n(9),s=n(0),u=n.n(s),d=n(8),m=n.n(d),h=n(4),f=n.n(h),E=(n(17),"twitchtactoe-lobby");function p(e){for(var t=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]],n=0;n<t.length;n++){var a=Object(i.a)(t[n],3),o=a[0],r=a[1],c=a[2];if(e[o]&&e[o]===e[r]&&e[o]===e[c])return e[o]}for(var l=0,s=0;s<e.length;s++)e[s]&&l++;return l===e.length?"draw":null}function v(e){return u.a.createElement("button",{className:"square",onClick:e.onClick},e.value)}function b(e){var t=e.friends.map((function(e){return u.a.createElement("li",{onClick:function(){document.getElementById("remotepeer").value=e},key:e},e)}));return u.a.createElement("ul",null,t)}var y={NOT_CONNECTED:"not_connected",PLAYER_X:"player_x",PLAYER_O:"player_o"},N=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(r.a)(this,Object(c.a)(t).call(this,e))).state={squares:Array(9).fill(null),xIsNext:!0,peer:new f.a,peer_id:null,conn:null,connState:y.NOT_CONNECTED,inlobby:[]},n.state.peer.on("open",(function(e){n.setState({peer_id:e});var t=n.state.peer.connect(E);t.on("open",(function(){console.log("connected to lobby");!function e(){t.send("QUERY"),n.state.connState===y.NOT_CONNECTED&&t.send("READY"),window.setTimeout(e,1e3)}()})),t.on("data",(function(e){console.log("setting lobby",e),n.setState({inlobby:e})}))})),n.state.peer.on("connection",(function(e){console.log("got connection from",e.peer),null==n.state.conn?(n.setState({conn:e,connState:y.PLAYER_O}),e.on("data",(function(e){console.log("Received",e),n.state.xIsNext&&n.handleFakeClick(Number(e))}))):(console.log("already connected"),e.close())})),n}return Object(l.a)(t,e),Object(o.a)(t,[{key:"handleClick",value:function(e){this.state.connState===y.PLAYER_X&&this.state.xIsNext?this.handleFakeClick(e):this.state.connState!==y.PLAYER_O||this.state.xIsNext||this.handleFakeClick(e)}},{key:"handleFakeClick",value:function(e){var t=this.state.squares.slice();p(t)||t[e]||(this.state.conn.send(e),t[e]=this.state.xIsNext?"X":"O",this.setState({squares:t,xIsNext:!this.state.xIsNext}))}},{key:"renderSquare",value:function(e){var t=this;return u.a.createElement(v,{value:this.state.squares[e],onClick:function(){return t.handleClick(e)}})}},{key:"connect",value:function(){var e=this,t=document.getElementById("remotepeer").value;console.log("connect to",t);var n=this.state.peer.connect(t);n.on("open",(function(){console.log("connection open"),e.setState({conn:n,connState:y.PLAYER_X})})),n.on("data",(function(t){console.log("Received back",t),e.state.xIsNext||e.handleFakeClick(Number(t))}))}},{key:"render",value:function(){var e,t=this,n=p(this.state.squares),a=this.state.connState;return e=null!=n?"draw"===n?"Game is a draw":"Winner: "+n:"Next player: "+(this.state.xIsNext?"X":"O"),u.a.createElement("div",null,u.a.createElement("div",{className:"connstatus"},a),u.a.createElement("div",{className:"status"},e),u.a.createElement("div",{className:"board-row"},this.renderSquare(0),this.renderSquare(1),this.renderSquare(2)),u.a.createElement("div",{className:"board-row"},this.renderSquare(3),this.renderSquare(4),this.renderSquare(5)),u.a.createElement("div",{className:"board-row"},this.renderSquare(6),this.renderSquare(7),this.renderSquare(8)),u.a.createElement("div",null,"My peer id is: ",this.state.peer_id),u.a.createElement("input",{type:"text",placeholder:"remote peer id",id:"remotepeer"}),u.a.createElement("input",{type:"submit",value:"connect",onClick:function(){return t.connect()}}),u.a.createElement("h3",null,"Click a user to challenge"),u.a.createElement("div",null,u.a.createElement(b,{friends:this.state.inlobby})))}}]),t}(u.a.Component),k=function(e){function t(){return Object(a.a)(this,t),Object(r.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){console.log("trying to create lobby");var e={},t=new f.a(E);t.on("open",(function(e){console.log("Lobby peer ID is: "+e)})),t.on("connection",(function(t){console.log("lobby connection",t.peer),t.on("data",(function(n){"READY"===n&&(e[t.peer]=(new Date).getTime()),"QUERY"===n&&t.send(Object.keys(e))}))})),function t(){for(var n in e){(new Date).getTime()-e[n]>3e3&&delete e[n]}window.setTimeout(t,1e3)}()}},{key:"render",value:function(){return u.a.createElement("div",{className:"game"},u.a.createElement("div",{className:"game-board"},u.a.createElement(N,null)),u.a.createElement("div",{className:"game-info"},u.a.createElement("div",null),u.a.createElement("ol",null)))}}]),t}(u.a.Component);m.a.render(u.a.createElement(k,null),document.getElementById("root"))},16:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=16},17:function(e,t,n){}},[[10,1,2]]]);
//# sourceMappingURL=main.967bb908.chunk.js.map